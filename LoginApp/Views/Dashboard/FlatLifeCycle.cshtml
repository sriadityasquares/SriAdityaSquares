@model ModelLayer.PaymentInformation
@{
    ViewBag.Title = "FlatLifeCycle";
    ViewBag.FlatLifeCycle = "active";
    ViewBag.Dashboard = "active";

}

<div id="jumbo" class="jumbotron" style="padding-bottom:2px;margin-bottom:2px;">
    @*<div class="row">
            <div class="col-md-1 col-xs">
                <h3 align="center" style="margin-bottom:2px">FLAT LIFECYCLE</h3>
                <div class="specialLine"></div>
            </div>

        </div>*@
    <div class="row">
        <div class="col-md-12 col-xs" style="margin-top:0px">
            <h3 style="margin-top:0px;margin-bottom:4px" align="left">FLAT LIFE CYCLE</h3>
            <div class="specialLine col-md-1"></div>
        </div>

    </div>
    <div class="row" style="padding-top:10px">
        @Html.LabelFor(m => m.ProjectID, new { @class = "col-md-1" })
        @Html.DropDownListFor(model => model.ProjectID, TempData["ProjectList"] as SelectList, "--Select Project--", new { @class = "textbox-control col-md-3 col-xs" })
        @Html.LabelFor(m => m.TowerID, new { @class = "col-md-1" })
        @Html.DropDownListFor(model => model.TowerID, new SelectList(" "), "--Select Tower--", new { @class = "textbox-control col-md-3 col-xs" })
        @Html.LabelFor(m => m.FlatID, new { @class = "col-md-1" })
        @Html.DropDownListFor(model => model.FlatID, new SelectList(" "), "--Select Flat--", new { @class = "textbox-control col-md-3 col-xs" })
    </div>
    <div class="row" style="padding-top:10px">
        <div style="align-items:center;align-content:center" class="col-md-6 col-xs">
            <label> Name :
            </label>
            <label id="spanNAME">
            </label>
        </div>
        <div class="col-md-6 col-xs">
            <label>
                Scheme :
            </label>
            <label id="spanScheme">
            </label>
        </div>
        
    </div>
    <div class="row" style="padding-top:20px">
        
        <div class="col-md-12 col-sm-12 col-xs-12" id="timelinePosition">
            <br />
            <div style="overflow:auto;height:700px;" id="bookingstatus"></div>
        </div>
    </div>
</div>
<script>
    var html = '';

    $("#ProjectID").change(function () {
        $.get("/Booking/GetTowers", { ProjectId: $("#ProjectID").val() }, function (data) {
            //HideDiv();
            $("#TowerID").empty();
            $("#TowerID").append("<option value='" + 0 + "'>" + "--Select Tower--" + "</option>")
            $("#FlatID").empty();
            $("#FlatID").append("<option value='" + 0 + "'>" + "--Select Flat--" + "</option>")
            $.each(data, function (index, row) {
                $("#TowerID").append("<option value='" + row.TowerID + "'>" + row.TowerName + "</option>")
            });
        });
    });

    $("#TowerID").change(function () {

        $.get("/Booking/GetFlatsExceptOpen", { TowerID: $("#TowerID").val() }, function (data) {
            //$("#TowerID").empty();
            //$("#TowerID").append("<option value='" + 0 + "'>" + "--Select Tower--" + "</option>")
            //HideDiv();
            $("#FlatID").empty();
            $("#FlatID").append("<option value='" + 0 + "'>" + "--Select Flat--" + "</option>")
            $.each(data, function (index, row) {
                $("#FlatID").append("<option value='" + row.FlatID + "'>" + row.FlatName + "</option>")
            });
        });
    });

    $("#FlatID").change(function () {
        var html = ''
        $.get("/Dashboard/GetFlatLifeCycle", { flatID: $("#FlatID").val() }, function (data) {
            
            $.each(data, function (index, row) {
                if (index == 0) {
                    
                    html = '<div  class="col-xs-10 col-xs-offset-1 col-sm-8 col-sm-offset-2"><ul class="timeline">';
                    html = html + ' <li class="timeline-item"> <div class="timeline-info"><span>' + row.CreatedDate + '</span> </div><div class="timeline-marker"></div> <div class="timeline-content"><h3 style="color:#ea4f4c" class="timeline-title">' + row.FlatEvent + '</h3><p style="width:230px" >BOOKING AMOUNT :<b> Rs. </b><b style="color:BLACK">' + row.BookingAmount + '</b></p><p style="width:230px" >BALANCE AMOUNT :<b> Rs. </b><b style="color:BLACK">' + row.BalanceAmount + '</b></p> </div></li>'
                    $("#spanNAME").text(row.Name);
                    $("#spanScheme").text(row.SchemeName);
                }
                else {
                    if (row.BalanceAmount != 0) {
                        html = html + ' <li class="timeline-item"> <div class="timeline-info"><span>' + row.CreatedDate + '</span> </div><div class="timeline-marker"></div> <div class="timeline-content"><h3 style="color:#ea4f4c" class="timeline-title">' + row.FlatEvent + '</h3><p style="width:230px" >AMOUNT PAID :<b> Rs. </b><b style="color:BLACK">' + row.BookingAmount + '</b></p><p style="width:230px" >BALANCE AMOUNT :<b> Rs. </b><b style="color:BLACK">' + row.BalanceAmount + '</b></p> </div></li>'
                    }
                    else {
                        html = html + ' <li class="timeline-item"> <div class="timeline-info"><span>' + row.CreatedDate + '</span> </div><div class="timeline-marker"></div> <div class="timeline-content"><h3 style="color:#ea4f4c" class="timeline-title">' + row.FlatEvent + '</h3><p style="width:230px" >FINAL PAYMENT :<b> Rs. </b><b style="color:BLACK">' + row.BookingAmount + '</b></p><p style="width:230px" >BALANCE AMOUNT :<b> Rs. </b><b style="color:BLACK">' + row.BalanceAmount + '</b></p> </div></li>'
                    }
                }

            })
            html = html + ' </ul></div>';
            $('#bookingstatus').html(html);
        })
    });
</script>
<style>
    #bookingstatus{
        height :550px;
    }
   
    @@media screen and (max-width: 700px) {
        #bookingstatus {
            height: 250px;
        }
        
}

</style>
